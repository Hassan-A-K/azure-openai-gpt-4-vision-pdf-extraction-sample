You are a senior engineering document controller. I will provide a document to document type and discipline code, also provide a list of metadata to capture. Besides I also need tags pulled out of these documents in a specific format which I'll provide. Here are the metadata fields that need to be captured:
Document Title	
Date of Document (Find the most recent date on the document)
Document Revision	
Document Type
Discipline
Legacy Number	
Equipment
Sub-Equipment
Tag Number	
Project ID (AFE Number - From Folder)	
Facility Code
Third Party Name

Here are the list of documents to discipline to document types mapping:

 3D Scans	ALL - All Disciplines		MOD - Model
AB-31.96.81/83/25 	RCM - Regulatory		PER - Pipeline License and Audit Packages
ABSA Registration Package	RCM - Regulatory		PER - Pipeline License and Audit Packages
AER Pipeline, Facility and WM Licenses	RCM - Regulatory		PER - Pipeline License and Audit Packages
Calculations - Compressor Curves	RCM - Regulatory		CAL - Calculations
Calculations - Control Valve	IAC - Instrumentation and Controls		CAL - Calculations
Calculations - Equipment Sizing Calculations	PRS - Process		CAL - Calculations
Calculations - Flowline Sizing	PRS - Process		CAL - Calculations
Calculations - Heat Exchangers	PRS - Process		CAL - Calculations
Calculations - Hydraulic Calculations	PRS - Process		CAL - Calculations
Calculations - Hydraulic Models	PRS - Process		CAL - Calculations
Calculations - Presure Safety Valve	PRS - Process		CAL - Calculations
Calculations - Pump Curves	PRS - Process		CAL - Calculations
Calculations - Stress Analysis	MEC - Mechanical		CAL - Calculations
Carseal List	MEC - Mechanical		LST - List
Cathodic Protection Design 	MEC - Mechanical		Varies - Depends on document located
Cathodic Protection Inspection records (Annual survey and periodic inspections)	MEC - Mechanical		REP - Report
Coating Report / Certificate	MEC - Mechanical		REP - Report
Consequence Models - Blast Study / Model	PRS - Process		MOD - Model
Consequence Models - BLEVE Studies - Boiling Liquid Expanding Vapor Explosion	PRS - Process		MOD - Model
Consequence Models - Dispersion Modelling	PRS - Process		MOD - Model
Consequence Models - QRA - Quantitative Risk Assessments	PRS - Process		MOD - Model
Consequence Models - Safe Operating Limit Table	PRS - Process		MOD - Model
Consequence Models - Toxic Release Studies	PRS - Process		MOD - Model
Control Narrative	IAC - Instrumentation and Controls		NAR - Narrative
Control System Change Notice	IAC - Instrumentation and Controls		NTC - Notice
Corrosion Analysis	MEC - Mechanical		STU - Study or Analysis
Coupon Analysis	MEC - Mechanical		STU - Study or Analysis
Data Sheets (Pump, Tank, Compressor, etc)	Various (select on case by case)	SELECT FROM ALL TYPES	DST - Data Sheet
Engineering Studies - Area Classification Report	ELE - Electrical		REP - Report
Engineering Studies - Compressor Curves	MEC - Mechanical		STU - Study or Analysis
Engineering Studies - Electrical Load Study	ELE - Electrical		STU - Study or Analysis
Engineering Studies - Foundation Load Study	CIV - Civil		STU - Study or Analysis
Engineering Studies - Geotechnical Study	CIV - Civil		STU - Study or Analysis
Engineering Studies - Hydraulic/Transient/Surge Analysis	MEC - Mechanical		STU - Study or Analysis
Engineering Studies - Power Coordination Study	ELE - Electrical		STU - Study or Analysis
Engineering Studies - Pressure Protection Calculations	MEC - Mechanical		CAL - Calculations
Engineering Studies - RATS - Range Alarm and Trip Setpoints	IAC - Instrumentation and Controls		LST - List
Engineering Studies - Stress Analysis	PIP - Piping		STU - Study or Analysis
Engineering Studies - Tank Berm Calculations	CIV - Civil		CAL - Calculations
Environment Studies	CIV - Civil		STU - Study or Analysis
Environmental Emergency Plans	CIV - Civil		PLN - Plan
EPEA Approvals and Applications	RCM - Regulatory		CER - Certificate/Certification
ERP - Consequence Analysis	RCM - Regulatory		STU - Study or Analysis
Failure Analysis	Various		STU - Study or Analysis
Fitness for Service Calculations for all Equipment	Various		CAL - Calculations
Groundwater Studies	CIV - Civil		STU - Study or Analysis
Hazop Closeout Sheets - Hazard and Operability Analysis	PRS - Process		STU - Study or Analysis
In-line Inspection (ILI) Assessments/Reports	MEC - Mechanical		REP - Report
In-line Inspection (ILI) Calculations (Fitness for service for pipelines)	MEC - Mechanical		CAL - Calculations
Inspection Reports	Various		REP - Report
Installation Specifications or Details	Various		SPC - Specifications 
Installation, Operations & Maintenance  Manual (IOM)	Various		MAN - Manual
Instrument Calibration/Commissioning Forms	IAC - Instrumentation and Controls		REP - Report
Leak Detection FDS (Functional Design Specs)	MEC - Mechanical		SPC - Specifications 
Maintenance Manual 	Various		MAN - Manual
Material Selection/Metalurgical Studies	Various		STU - Study or Analysis
Material Testing (Impact testing, etc.)	Various		REP - Report
Navis Works Files (.nwd)	ALL - All Disciplines		MOD - Model
Network Drawings	IAC - Instrumentation and Controls		DWG - Drawing
Nondestructive Evaluation (NDE) findings	MEC - Mechanical		REP - Report
Pipeline Integrity Assessment/Reports	MEC - Mechanical		REP - Report
Pond Operation Policies	CIV - Civil		POL - Policy
Process Model (Hysys)	PRS - Process		MOD - Model
Project Technical Specifications/Deviations	Various		SPC - Specifications 
PSV Datasheets including Reaction Forces	IAC - Instrumentation and Controls		DST - Data Sheet
Pump Curves	MEC - Mechanical		STU - Study or Analysis
Construction QC Databook	Various		DBK - Data Book
Risk Assessments - LOPA - Layer of Protection Analysis 	PRS - Process		STU - Study or Analysis
Risk Assessments - PHA - Process Hazard Assessment 	PRS - Process		HAZ - Process Hazard Assessments (Signed)
Risk Assessments - What-If	PRS - Process		HAZ - Process Hazard Assessments (Signed)
Soil Studies	CIV - Civil		STU - Study or Analysis
Spare Parts List 	Various		LST - List
Specialty Item Datasheets	Various		DST - Data Sheet
Tank Alarm Setpoint Calculations	IAC - Instrumentation and Controls		CAL - Calculations
Tank Alteration Repair Strategies	MEC - Mechanical		STU - Study or Analysis
Tank As Built Drawings	MEC - Mechanical		DWG - Drawing
Tank Data Book 	MEC - Mechanical		DBK - Data Book
Tank Datasheets	MEC - Mechanical		DST - Data Sheet
Tank Design Calculations Information (Wind/snow load on roof, venting etc.,)	MEC - Mechanical		CAL - Calculations
Tank Floating Roof Seal Drawings 	MEC - Mechanical		DWG - Drawing
Tank Foundation (Geotechnical study if available)	CIV - Civil		STU - Study or Analysis
Tank Hydrotest Information	MEC - Mechanical		REP - Report
Tank Initial Fill Rate (Static Electricity Limitiations)	MEC - Mechanical		REP - Report
Tank Inspection (internal, external and settlement surveys)	MEC - Mechanical		REP - Report
Tank Insulation system (materials and application procedure)	MEC - Mechanical		Varies - Depends on document located
Tank Integrity Risk Assessments	MEC - Mechanical		REP - Report
Tank ITPs (Inspection and Test Plans)	MEC - Mechanical		PLN - Plan
Tank Leak Detection Details (Release Prevention Barrier)	MEC - Mechanical		REP - Report
Tank Strapping Tables	MEC - Mechanical		MTX - Matrix/Table/Chart/RACI
Tank Volume Assessments incl Displacement	MEC - Mechanical		REP - Report
TDL and Water Act Licenses	RCM - Regulatory		CER - Certificate/Certification
Test Certificates (Pressure / Hydro)	MEC - Mechanical		CER - Certificate/Certification
Vendor Data Package	Various		DBK - Data Book
Vendor Drawings	Various		DWG - Drawing
Vendor Information - Bill of Materials	Various		BOM - Bill of Materials

Here are the tag formats that I need from the documents under the tags field. Please have the results captured in the respective column with pipe separation

A-123456
AA-123456
AAA-123456
AAAA-1234567
AAAA-123456-7
AAAA-123456A
AAAA-123456-A